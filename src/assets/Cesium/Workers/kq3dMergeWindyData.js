define(["./createTaskProcessorWorker","./when-4bbc8319"],function(e,a){"use strict";function H(e,a){let r={dimensions:{}};var l=e.header.dx,n=e.header.dy,t=Math.min(e.header[a.lo1],e.header[a.lo2]),h=Math.max(e.header[a.lo1],e.header[a.lo2]),d=Math.min(e.header[a.la1],e.header[a.la2]),i=Math.max(e.header[a.la1],e.header[a.la2]),l=Math.abs((h-t)/l),n=Math.abs((i-d)/n);r.speedUnit=e.header.parameterUnit,r.dimensions.lon=l,r.dimensions.lat=n,r.dimensions.lev=1,r.lon={},r.lon.min=t,r.lon.max=h,r.lon.interval=Number(e.header.dx),r.lat={},r.lat.min=d,r.lat.max=i,r.lat.interval=Number(e.header.dy),e.header[a.la1]>e.header[a.la2]&&(r.lat.min=i,r.lat.max=d,r.lat.interval=-Math.abs(r.lat.interval)),r.lev={},r.lev.min=1,r.lev.max=1,r.U={},r.U.array=new Float32Array(e[a.U]);var i=e.header[a.U][1],d=e.header[a.U][0];r.U.min=i,r.U.max=d,r.V={},r.V.array=new Float32Array(e[a.V]);i=e.header[a.V][1],d=e.header[a.V][0];return r.V.min=i,r.V.max=d,r}return e(function(e,a){try{var r=e.jsonArray;if(!r||0===r.length)return;var l=e.netCDFFieldInfor;if(1===r.length)return H(r[0],l);var n=r[0].header,t=Math.min(n[l.lo1],n[l.lo2]),h=Math.max(n[l.lo1],n[l.lo2]),d=Math.min(n[l.la1],n[l.la2]),i=Math.max(n[l.la1],n[l.la2]);r[0].header.lonMin=t,r[0].header.latMin=d;for(var o=n.dx,m=n.dy,s=n.nx,M=n.ny,v=h-t,U=n[l.U][0],x=n[l.U][1],u=n[l.V][0],y=n[l.V][1],V=1;V<r.length;V++){U<(T=r[V].header)[l.U][0]&&(U=T[l.U][0]),x>T[l.U][1]&&(x=T[l.U][1]),u<T[l.V][0]&&(u=T[l.V][0]),y>T[l.V][1]&&(y=T[l.V][1]);var c=Math.min(T[l.lo1],T[l.lo2]),f=Math.max(T[l.lo1],T[l.lo2]),b=Math.min(T[l.la1],T[l.la2]),p=Math.max(T[l.la1],T[l.la2]);r[V].header.lonMin=c,r[V].header.latMin=b,c<t&&(t=c),h<f&&(h=f),b<d&&(d=b),i<p&&(i=p)}var N=(h-t)/v,g=(i-d)/v,w={header:{dx:Math.abs(o),dy:Math.abs(m),nx:s*N,ny:M*g,parameterCategory:n.parameterCategory,parameterNumber:n.parameterNumber,parameterNumberName:n.parameterNumberName,parameterUnit:n.parameterUnit,refTime:n.refTime}};w.header[l.U]=[U,x],w.header[l.V]=[u,y],w.header[l.lo1]=t,w.header[l.lo2]=h,w.header[l.la1]=d,w.header[l.la2]=i;var A=w.header.nx,F=A*w.header.ny;w[l.U]=new Array(F).fill(null),w[l.V]=new Array(F).fill(null);for(var k=w[l.U],C=w[l.V],V=0;V<r.length;V++)for(var T=r[V].header,j=Math.round(T.lonMin-t)/v,D=A*(Math.round(T.latMin-d)/v)*M+j*s,I=r[V][l.U],P=r[V][l.V],W=r[V].header.dx,q=r[V].header.dy,z=0;z<M;z++){var B=(M-z-1)*s,E=I.slice(B,B+s),G=P.slice(B,B+s);W<0&&(E=E.reverse()),q<0&&(G=G.reverse()),k.splice(D,s,...E),C.splice(D,s,...G),D+=A}return w[l.U]=k,w[l.V]=C,H(w,l)}catch(e){console.log("worker error:"+e)}})});
